<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì ë§Œë³´ ë‹¤ì´ìŠ¤ ê²Œì„ ì ìˆ˜íŒ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Malgun Gothic', sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 2em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .player-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .player-controls label {
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .player-controls input {
            width: 80px;
            padding: 8px;
            font-size: 1.1em;
            text-align: center;
            border: 2px solid #667eea;
            border-radius: 5px;
        }
        
        .player-controls button {
            padding: 10px 20px;
            font-size: 1em;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .player-controls button:hover {
            background: #5568d3;
        }
        
        .score-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            overflow-x: auto;
            display: block;
        }
        
        table {
            width: 100%;
            min-width: 600px;
        }
        
        th, td {
            border: 2px solid #ddd;
            padding: 12px;
            text-align: center;
        }
        
        th {
            background: #667eea;
            color: white;
            font-weight: bold;
            position: sticky;
            top: 0;
        }
        
        .category-cell {
            background: #f8f9fa;
            font-weight: bold;
            text-align: left;
            padding-left: 15px;
            min-width: 150px;
        }
        
        .score-cell {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            font-size: 1.2em;
            cursor: pointer;
            background: white;
            transition: all 0.2s;
            user-select: none;
            font-weight: bold;
            min-height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .score-cell:hover {
            background: #f0f4ff;
            border-color: #667eea;
            transform: scale(1.05);
        }
        
        .score-cell:active {
            transform: scale(0.95);
        }
        
        .score-cell.empty {
            color: #ccc;
        }
        
        .score-cell.filled {
            color: #333;
            background: #e8f5e9;
        }
        
        .total-row {
            background: #fff3cd;
            font-weight: bold;
        }
        
        .bonus-row {
            background: #d1ecf1;
            font-weight: bold;
        }
        
        .section-divider {
            height: 3px;
            background: #667eea;
        }
        
        .grand-total-row {
            background: #d4edda;
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .total-cell {
            font-size: 1.1em;
            color: #333;
        }
        
        .point-label {
            color: #666;
            font-size: 0.9em;
            margin-left: 5px;
        }
        
        .category-title {
            font-size: 1.1em;
            font-weight: bold;
            color: #333;
            display: block;
            margin-bottom: 3px;
        }
        
        .category-desc {
            font-size: 0.9em;
            font-weight: normal;
            color: #555;
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ» ì ë§Œë³´ ë‹¤ì´ìŠ¤ ê²Œì„</h1>
        <p class="subtitle">ì ìˆ˜ ê³„ì‚°ê¸°</p>
        
        <div class="player-controls">
            <label for="playerCount">í”Œë ˆì´ì–´ ìˆ˜:</label>
            <input type="number" id="playerCount" min="1" max="8" value="2">
            <button onclick="updatePlayers()">ì ìš©</button>
        </div>
        
        <div class="score-table">
            <table id="scoreTable">
                <thead>
                    <tr>
                        <th class="category-cell">ì¹´í…Œê³ ë¦¬</th>
                    </tr>
                </thead>
                <tbody id="scoreBody">
                </tbody>
            </table>
        </div>
    </div>

    <script>
        const categories = {
            upper: [
                { id: 'ones', title: 'ì—ì´ìŠ¤', name: 'ëª¨ë“  ì ë§Œë³´ë“¤ì˜ í•© <span class="point-label">(0~5ì )</span>', multiplier: 1, maxCount: 5 },
                { id: 'twos', title: 'ë“€ìŠ¤', name: 'ëª¨ë“  2ë“¤ì˜ í•© <span class="point-label">(0~10ì )</span>', multiplier: 2, maxCount: 5 },
                { id: 'threes', title: 'íŠ¸ë ˆì´', name: 'ëª¨ë“  3ë“¤ì˜ í•© <span class="point-label">(0~15ì )</span>', multiplier: 3, maxCount: 5 },
                { id: 'fours', title: 'í¬', name: 'ëª¨ë“  4ë“¤ì˜ í•© <span class="point-label">(0~20ì )</span>', multiplier: 4, maxCount: 5 },
                { id: 'fives', title: 'íŒŒì´ë¸Œ', name: 'ëª¨ë“  5ë“¤ì˜ í•© <span class="point-label">(0~25ì )</span>', multiplier: 5, maxCount: 5 },
                { id: 'sixes', title: 'ì‹ìŠ¤', name: 'ëª¨ë“  6ë“¤ì˜ í•© <span class="point-label">(0~30ì )</span>', multiplier: 6, maxCount: 5 }
            ],
            lower: [
                { id: 'fourKind', title: 'í¬ ë‹¤ì´ìŠ¤', name: '4ê°œê°€ ê°™ì„ ë•Œ', fixed: 25 },
                { id: 'twoPairPlusOne', title: 'í’€ í•˜ìš°ìŠ¤', name: '2ê°œê°€ ê°™ê³  ë‚˜ë¨¸ì§€ 3ê°œê°€ ê°™ì„ ë•Œ', fixed: 25 },
                { id: 'fourSequence', title: 'ìŠ¤ëª° ìŠ¤íŠ¸ë ˆì´íŠ¸', name: '4ê°œê°€ ì—°ì†ëœ ìˆ«ìì¼ ë•Œ', fixed: 15 },
                { id: 'fiveSequence', title: 'ë¼ì§€ ìŠ¤íŠ¸ë ˆì´íŠ¸', name: '5ê°œê°€ ì—°ì†ëœ ìˆ«ìì¼ ë•Œ', fixed: 30 },
                { id: 'fiveKind', title: 'ìš”íŠ¸', name: 'ëª¨ë‘ ê°™ì„ ë•Œ', fixed: 50 },
                { id: 'allOnes', title: 'ì ë§Œë³´!', name: 'ëª¨ë‘ ì ë§Œë³´ì¼ ë•Œ', fixed: 100 }
            ]
        };

        // ê° í”Œë ˆì´ì–´ì˜ í˜„ì¬ ìƒíƒœë¥¼ ì €ì¥
        const playerStates = {};

        function initializePlayerState(playerNum) {
            if (!playerStates[playerNum]) {
                playerStates[playerNum] = {};
                
                // ìƒë‹¨ ì´ˆê¸°í™” (ê°ê° -1ë¡œ ì‹œì‘, -1ì€ ë¹ˆ ìƒíƒœ)
                categories.upper.forEach(cat => {
                    playerStates[playerNum][cat.id] = -1;
                });
                
                // í•˜ë‹¨ ì´ˆê¸°í™” (ê°ê° -1ë¡œ ì‹œì‘)
                categories.lower.forEach(cat => {
                    playerStates[playerNum][cat.id] = -1;
                });
            }
        }

        function createScoreTable() {
            const playerCount = parseInt(document.getElementById('playerCount').value);
            const thead = document.querySelector('#scoreTable thead tr');
            const tbody = document.getElementById('scoreBody');
            
            // í”Œë ˆì´ì–´ ìƒíƒœ ì´ˆê¸°í™”
            for (let i = 1; i <= playerCount; i++) {
                initializePlayerState(i);
            }
            
            // í—¤ë” ìƒì„±
            thead.innerHTML = '<th class="category-cell">ì¹´í…Œê³ ë¦¬</th>';
            for (let i = 1; i <= playerCount; i++) {
                thead.innerHTML += `<th>í”Œë ˆì´ì–´ ${i}</th>`;
            }
            
            // ë°”ë”” ì´ˆê¸°í™”
            tbody.innerHTML = '';
            
            // ìƒë‹¨ ì„¹ì…˜
            categories.upper.forEach(cat => {
                const row = createScoreRow(cat, playerCount, 'upper');
                tbody.appendChild(row);
            });
            
            // ìƒë‹¨ í•©ê³„
            const upperTotalRow = document.createElement('tr');
            upperTotalRow.className = 'total-row';
            upperTotalRow.innerHTML = `<td class="category-cell">ìƒë‹¨ í•©ê³„</td>`;
            for (let i = 1; i <= playerCount; i++) {
                upperTotalRow.innerHTML += `<td class="total-cell" id="upperTotal_${i}">0</td>`;
            }
            tbody.appendChild(upperTotalRow);
            
            // ë³´ë„ˆìŠ¤
            const bonusRow = document.createElement('tr');
            bonusRow.className = 'bonus-row';
            bonusRow.innerHTML = `<td class="category-cell">63ì  ì´ìƒ ë³´ë„ˆìŠ¤ <span class="point-label">(35ì )</span></td>`;
            for (let i = 1; i <= playerCount; i++) {
                bonusRow.innerHTML += `<td class="total-cell" id="bonus_${i}">0</td>`;
            }
            tbody.appendChild(bonusRow);
            
            // êµ¬ë¶„ì„ 
            const divider = document.createElement('tr');
            divider.innerHTML = `<td colspan="${playerCount + 1}" class="section-divider"></td>`;
            tbody.appendChild(divider);
            
            // í•˜ë‹¨ ì„¹ì…˜
            categories.lower.forEach(cat => {
                const row = createScoreRow(cat, playerCount, 'lower');
                tbody.appendChild(row);
            });
            
            // í•˜ë‹¨ í•©ê³„
            const lowerTotalRow = document.createElement('tr');
            lowerTotalRow.className = 'total-row';
            lowerTotalRow.innerHTML = `<td class="category-cell">í•˜ë‹¨ í•©ê³„</td>`;
            for (let i = 1; i <= playerCount; i++) {
                lowerTotalRow.innerHTML += `<td class="total-cell" id="lowerTotal_${i}">0</td>`;
            }
            tbody.appendChild(lowerTotalRow);
            
            // ì´ í•©ê³„
            const grandTotalRow = document.createElement('tr');
            grandTotalRow.className = 'grand-total-row';
            grandTotalRow.innerHTML = `<td class="category-cell">ì´ í•©ê³„</td>`;
            for (let i = 1; i <= playerCount; i++) {
                grandTotalRow.innerHTML += `<td class="total-cell" id="grandTotal_${i}">0</td>`;
            }
            tbody.appendChild(grandTotalRow);
            
            // ëª¨ë“  í”Œë ˆì´ì–´ì˜ í•©ê³„ ê³„ì‚°
            for (let i = 1; i <= playerCount; i++) {
                calculateTotals(i);
            }
        }
        
        function createScoreRow(cat, playerCount, section) {
            const row = document.createElement('tr');
            // í•˜ë‹¨ë§Œ pointLabel ì¶”ê°€
            const pointLabel = section === 'lower' ? ` <span class="point-label">(0ì  / ${cat.fixed}ì )</span>` : '';
            
            const displayName = cat.title 
                ? `<span class="category-title">${cat.title}</span><span class="category-desc">${cat.name}${pointLabel}</span>`
                : cat.name + pointLabel;
            
            row.innerHTML = `<td class="category-cell">${displayName}</td>`;
            
            for (let i = 1; i <= playerCount; i++) {
                const cellId = `${cat.id}_${i}`;
                row.innerHTML += `
                    <td>
                        <div class="score-cell empty" id="${cellId}" onclick="cycleScore('${cat.id}', ${i}, '${section}')">
                            -
                        </div>
                    </td>
                `;
            }
            
            return row;
        }
        
        function cycleScore(catId, playerNum, section) {
            initializePlayerState(playerNum);
            
            const currentState = playerStates[playerNum][catId];
            let newState;
            let displayValue;
            let scoreValue;
            
            if (section === 'upper') {
                // ìƒë‹¨: - â†’ 0 â†’ 1 â†’ 2 â†’ 3 â†’ 4 â†’ 5 â†’ -
                const cat = categories.upper.find(c => c.id === catId);
                const maxCount = cat.maxCount;
                
                if (currentState === -1) {
                    newState = 0;
                } else if (currentState >= maxCount) {
                    newState = -1;
                } else {
                    newState = currentState + 1;
                }
                
                if (newState === -1) {
                    displayValue = '-';
                    scoreValue = 0;
                } else {
                    scoreValue = newState * cat.multiplier;
                    displayValue = scoreValue;
                }
            } else {
                // í•˜ë‹¨: - â†’ 0 â†’ ì ìˆ˜ â†’ -
                const cat = categories.lower.find(c => c.id === catId);
                
                if (currentState === -1) {
                    newState = 0;
                    displayValue = '0';
                    scoreValue = 0;
                } else if (currentState === 0) {
                    newState = 1;
                    displayValue = cat.fixed;
                    scoreValue = cat.fixed;
                } else {
                    newState = -1;
                    displayValue = '-';
                    scoreValue = 0;
                }
            }
            
            // ìƒíƒœ ì €ì¥
            playerStates[playerNum][catId] = newState;
            
            // UI ì—…ë°ì´íŠ¸
            const cell = document.getElementById(`${catId}_${playerNum}`);
            cell.textContent = displayValue;
            
            if (newState === -1) {
                cell.classList.add('empty');
                cell.classList.remove('filled');
            } else {
                cell.classList.remove('empty');
                cell.classList.add('filled');
            }
            
            // í•©ê³„ ì¬ê³„ì‚°
            calculateTotals(playerNum);
        }
        
        function calculateTotals(playerNum) {
            let upperTotal = 0;
            
            // ìƒë‹¨ í•©ê³„
            categories.upper.forEach(cat => {
                const state = playerStates[playerNum][cat.id];
                if (state >= 0) {
                    upperTotal += state * cat.multiplier;
                }
            });
            
            // í•˜ë‹¨ í•©ê³„
            let lowerTotal = 0;
            categories.lower.forEach(cat => {
                const state = playerStates[playerNum][cat.id];
                if (state === 1) {
                    lowerTotal += cat.fixed;
                }
            });
            
            // ë³´ë„ˆìŠ¤ ê³„ì‚°
            const bonus = upperTotal >= 63 ? 35 : 0;
            
            // ì´ í•©ê³„
            const grandTotal = upperTotal + bonus + lowerTotal;
            
            // ì—…ë°ì´íŠ¸
            document.getElementById(`upperTotal_${playerNum}`).textContent = upperTotal;
            document.getElementById(`bonus_${playerNum}`).textContent = bonus;
            document.getElementById(`lowerTotal_${playerNum}`).textContent = lowerTotal;
            document.getElementById(`grandTotal_${playerNum}`).textContent = grandTotal;
        }
        
        function updatePlayers() {
            createScoreTable();
        }
        
        // ì´ˆê¸° í…Œì´ë¸” ìƒì„±
        createScoreTable();
    </script>
</body>
</html>
